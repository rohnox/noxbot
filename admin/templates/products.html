{% extends 'base.html' %}
{% block content %}
<h2 class="text-lg font-bold mb-4">محصولات / پلن‌ها</h2>

<div class="grid md:grid-cols-2 gap-6">
  <!-- فرم ساخت -->
  <div class="bg-white rounded-2xl p-6 shadow">
    <h3 class="font-bold mb-3">افزودن محصول جدید</h3>
    <form method="post" action="/products/create" class="space-y-3">
      <div>
        <label class="block text-sm mb-1">دسته</label>
        <select name="kind" class="w-full border rounded px-3 py-2">
          <option value="premium">premium</option>
          <option value="stars">stars</option>
        </select>
      </div>
      <div>
        <label class="block text-sm mb-1">نام (مثال: Premium 1M)</label>
        <input name="name" class="w-full border rounded px-3 py-2" required />
      </div>
      <div>
        <label class="block text-sm mb-1">قیمت</label>
        <input name="price" type="number" class="w-full border rounded px-3 py-2" required />
      </div>
      <div>
        <label class="block text-sm mb-1">ارز</label>
        <input name="currency" value="IRR" class="w-full border rounded px-3 py-2" />
      </div>
      <div class="flex items-center gap-2">
        <input type="checkbox" name="is_active" checked />
        <span>فعال</span>
      </div>
      <button class="px-4 py-2 bg-green-600 text-white rounded">ذخیره</button>
    </form>
  </div>

  <!-- لیست محصولات -->
  <div class="bg-white rounded-2xl p-6 shadow overflow-x-auto">
    <table class="w-full text-right">
      <thead class="bg-slate-100">
        <tr>
          <th class="p-2">#</th>
          <th class="p-2">نام</th>
          <th class="p-2">دسته</th>
          <th class="p-2">قیمت</th>
          <th class="p-2">ارز</th>
          <th class="p-2">وضعیت</th>
          <th class="p-2">اعمال</th>
        </tr>
      </thead>
      <tbody>
      {% for p in products %}
        <tr class="border-t">
          <td class="p-2">{{ p.id }}</td>
          <td class="p-2">
            <form method="post" action="/products/{{ p.id }}/update" class="flex gap-2">
              <input name="name" value="{{ p.name }}" class="border rounded px-2 py-1 w-36" />
              <input name="price" value="{{ p.price }}" class="border rounded px-2 py-1 w-24" />
              <input name="currency" value="{{ p.currency }}" class="border rounded px-2 py-1 w-20" />
              <button class="px-3 py-1 bg-blue-600 text-white rounded">بروزرسانی</button>
            </form>
          </td>
          <td class="p-2">{{ p.kind }}</td>
          <td class="p-2">{{ p.price }}</td>
          <td class="p-2">{{ p.currency }}</td>
          <td class="p-2">{{ 'فعال' if p.is_active else 'غیرفعال' }}</td>
          <td class="p-2">
            <form method="post" action="/products/{{ p.id }}/toggle" class="inline">
              <button class="px-2 py-1 bg-amber-500 text-white rounded">تغییر وضعیت</button>
            </form>
            <form method="post" action="/products/{{ p.id }}/delete" class="inline" onsubmit="return confirm('حذف شود؟');">
              <button class="px-2 py-1 bg-red-600 text-white rounded">حذف</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
