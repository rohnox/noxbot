# فقط پیام‌ها برای 'محصول' طراحی شده‌اند (نه پلن)
from typing import Dict

TEXTS: Dict[str, Dict[str, str]] = {
    "fa": {
        "welcome": "سلام {name}! به فروشگاه دیجیتال خوش آمدید.",
        "help": "دستورات:\n/store — مشاهده محصولات\n/orders — سفارش‌های من\n/help — راهنما",
        "only_admin": "این بخش مخصوص ادمین‌هاست.",
        "banned": "دسترسی شما محدود شده است.",
        "store_empty": "فعلاً محصولی فعال نیست.",
        "product_price": "قیمت: {price} {currency}",
        "buy": "خرید 🛒",
        "back": "بازگشت ⬅️",
        "order_created": "سفارش شما ثبت شد. کد پیگیری: {code}",
        "invoice_sent": "فاکتور ارسال شد. لطفاً پرداخت را تکمیل کنید.",
        "paid": "پرداخت موفق بود ✅",
        "delivered": "تحویل انجام شد ✅",
        "no_license": "فعلاً موجودی لایسنس این محصول تمام است. لطفاً بعداً تلاش کنید.",
        "orders_title": "سفارش‌های شما:",
        "admin_dashboard": "داشبورد ادمین — کاربران: {uc} | سفارش‌ها: {oc} | درآمد: {rev} {cur}",
        "admin_orders": "مدیریت سفارش‌ها",
        "admin_products": "مدیریت محصولات",
        "admin_settings": "تنظیمات",
        "admin_back": "بازگشت",
        "admin_order_line": "#{code} — {status} — {amount}{currency}",
        "admin_order_detail": "سفارش #{code}\nوضعیت: {status}\nمبلغ: {amount} {currency}\nایجاد: {created}\nپرداخت: {paid}\nتحویل: {delivered}\nکاربر: {uid}",
        "admin_set_status": "تغییر وضعیت",
        "admin_mark_paid": "پرداخت شد",
        "admin_mark_processing": "در حال پردازش",
        "admin_mark_delivered": "تحویل شد",
        "admin_mark_canceled": "لغو شد",
        "admin_mark_refunded": "عودت شد",
        "admin_products_list": "فهرست محصولات (فعال):",
        "admin_add_product": "افزودن محصول ➕",
        "admin_toggle": "فعال/غیرفعال",
        "admin_edit": "ویرایش",
        "admin_send_again": "ارسال مجدد کالا به کاربر",
        "admin_added_ok": "محصول ایجاد شد (#{pid}).",
        "admin_codes_added": "تعداد {n} کد لایسنس اضافه شد.",
        "admin_alert_new_order": "سفارش جدید #{code} از کاربر {uid}\nمحصول: {title}\nمبلغ: {amount} {currency}\nزمان: {ts}",
        "admin_alert_paid": "پرداخت شد ✅ — #{code} — کاربر {uid} — مبلغ {amount} {currency}",
        "unknown_cmd": "دستور نامعتبر. /help",
    },
    "en": {
        "welcome": "Welcome to the digital shop, {name}.",
        "help": "Commands:\n/store — browse products\n/orders — my orders\n/help — help",
        "only_admin": "Admins only.",
        "banned": "Access restricted.",
        "store_empty": "No active products yet.",
        "product_price": "Price: {price} {currency}",
        "buy": "Buy 🛒",
        "back": "Back ⬅️",
        "order_created": "Your order has been created. Tracking code: {code}",
        "invoice_sent": "Invoice sent. Please complete the payment.",
        "paid": "Payment successful ✅",
        "delivered": "Delivered ✅",
        "no_license": "This product is out of license stock for now.",
        "orders_title": "Your orders:",
        "admin_dashboard": "Admin Dashboard — Users: {uc} | Orders: {oc} | Revenue: {rev} {cur}",
        "admin_orders": "Orders",
        "admin_products": "Products",
        "admin_settings": "Settings",
        "admin_back": "Back",
        "admin_order_line": "#{code} — {status} — {amount}{currency}",
        "admin_order_detail": "Order #{code}\nStatus: {status}\nAmount: {amount} {currency}\nCreated: {created}\nPaid: {paid}\nDelivered: {delivered}\nUser: {uid}",
        "admin_set_status": "Set status",
        "admin_mark_paid": "Mark Paid",
        "admin_mark_processing": "Processing",
        "admin_mark_delivered": "Delivered",
        "admin_mark_canceled": "Canceled",
        "admin_mark_refunded": "Refunded",
        "admin_products_list": "Products (active):",
        "admin_add_product": "Add product ➕",
        "admin_toggle": "Toggle active",
        "admin_edit": "Edit",
        "admin_send_again": "Send goods again to user",
        "admin_added_ok": "Product created (#{pid}).",
        "admin_codes_added": "{n} license codes added.",
        "admin_alert_new_order": "New order #{code} from user {uid}\nProduct: {title}\nAmount: {amount} {currency}\nTime: {ts}",
        "admin_alert_paid": "Paid ✅ — #{code} — user {uid} — amount {amount} {currency}",
        "unknown_cmd": "Unknown command. /help",
    },
}

def t(lang: str, key: str, **kwargs) -> str:
    d = TEXTS.get(lang) or TEXTS.get("en", {})
    msg = d.get(key) or TEXTS.get("en", {}).get(key, key)
    try:
        return msg.format(**kwargs) if kwargs else msg
    except Exception:
        return msg
